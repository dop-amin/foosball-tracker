{% if games %}
<div class="table-responsive">
    <table class="table table-hover">
        <thead>
            <tr>
                <th>Date</th>
                <th>Type</th>
                <th>Teams</th>
                <th>Score</th>
                <th>ELO Change</th>
                <th>Duration</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            {% for game in games %}
            <tr class="{% if game.is_shutout %}shutout{% endif %}">
                <td>
                    {{ game.start_time.strftime('%Y-%m-%d %H:%M') }}
                </td>
                <td>
                    <span class="badge bg-secondary">{{ game.game_type }}</span>
                </td>
                <td>
                    <div class="small">
                        <strong>Black Side:</strong>
                        {% for gp in game.players if gp.team == 1 %}
                            <span class="{% if gp.is_winner %}text-success fw-bold{% endif %}">{{ gp.player.name }}</span>{% if not loop.last %}, {% endif %}
                        {% endfor %}
                        <br>
                        <strong>White Side:</strong>
                        {% for gp in game.players if gp.team == 2 %}
                            <span class="{% if gp.is_winner %}text-success fw-bold{% endif %}">{{ gp.player.name }}</span>{% if not loop.last %}, {% endif %}
                        {% endfor %}
                    </div>
                </td>
                <td>
                    <strong class="{% if game.team1_score > game.team2_score %}text-success{% elif game.team1_score < game.team2_score %}text-danger{% endif %}">
                        {{ game.team1_score }}
                    </strong>
                    -
                    <strong class="{% if game.team2_score > game.team1_score %}text-success{% elif game.team2_score < game.team1_score %}text-danger{% endif %}">
                        {{ game.team2_score }}
                    </strong>
                </td>
                <td>
                    <div class="small">
                        <strong>Black Side:</strong>
                        {% for gp in game.players if gp.team == 1 %}
                            <span class="{% if gp.elo_change > 0 %}text-success{% elif gp.elo_change < 0 %}text-danger{% endif %}">
                                {{ gp.player.name }}: {% if gp.elo_change > 0 %}+{% endif %}{{ gp.elo_change if gp.elo_change else '-' }}
                            </span>{% if not loop.last %}, {% endif %}
                        {% endfor %}
                        <br>
                        <strong>White Side:</strong>
                        {% for gp in game.players if gp.team == 2 %}
                            <span class="{% if gp.elo_change > 0 %}text-success{% elif gp.elo_change < 0 %}text-danger{% endif %}">
                                {{ gp.player.name }}: {% if gp.elo_change > 0 %}+{% endif %}{{ gp.elo_change if gp.elo_change else '-' }}
                            </span>{% if not loop.last %}, {% endif %}
                        {% endfor %}
                    </div>
                </td>
                <td>
                    {% if game.duration_minutes %}
                        <span class="game-duration">{{ game.duration_minutes }} min</span>
                    {% else %}
                        <span class="text-muted">-</span>
                    {% endif %}
                </td>
                <td>
                    {% if game.is_shutout %}
                        <span class="badge bg-info text-dark">ðŸŽ‚ Shutout!</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% set hx_get = url_for('get_games') %}
{% set hx_target = '#games-history' %}
{% include 'partials/pagination.html' %}

{% else %}
<p class="text-muted">No games recorded yet. Record your first game above!</p>
{% endif %}